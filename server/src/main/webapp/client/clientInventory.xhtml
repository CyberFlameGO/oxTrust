<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ox="http://xmlns.jcp.org/jsf/composite/ox"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:b="http://bootsfaces.net/ui" xmlns:a4j="http://richfaces.org/a4j"
	xmlns:richext="http://xmlns.jcp.org/jsf/composite/richext"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	template="/WEB-INF/incl/layout/newtemplate.xhtml">
	<f:metadata>
		<f:viewAction
			action="#{permissionService.requestPermission('client', 'access')}" />
		<f:viewParam name="searchPattern"
			value="#{searchClientAction.searchPattern}" />
		<f:viewAction action="#{conversationService.initConversation}" />
		<f:viewAction action="#{searchClientAction.start}"
			if="#{searchClientAction.clientList == null}" onPostback="false" />
	</f:metadata>

	<ui:define name="body">
		<section class="content-header">
			<h1 style="color: #333;">
				#{msg['client.openIDConnect']} <small> <i
					class="fa fa-caret-right" style="color: #333 !important;" />
					#{msg['client.clients']}
				</small>
			</h1>
			<ol class="breadcrumb">
				<li><a href="#{request.contextPath}/home.htm"> <i
						class="fa fa-home" />
				</a></li>
				<li class="organization/configuration"><a
					href="#{request.contextPath}/client/clientInventory.htm">
						#{msg['client.clients']}</a></li>
			</ol>
		</section>
		<div id="formArea" style="margin-top: 10px;">
			<div class="col-xs-12 col-md-12">
				<b:panel title="OpenID Connect Clients List" look="primary">
					<h:panelGroup id="oidcClientsTable">
						<div class="row"
							style="padding: 5px; margin-bottom: 5px; margin-left: 15px">
							<b:link style-class="addClientButtonClass btn btn-primary"
								icon="plus" outcome="/client/addClient" onclick="clearOIDC();"
								value="#{msg['client.addClient']}" includeViewParams="false" />
						</div>
						<richext:spacer height="16" />
						<h:form>
							<ox:decorate hideLabel="true" id="searchPattern">
								<div style="width: 100%; float: left; margin-left: 17px;">
									<h:inputText
										alt="Search parameters for client like inum,iname,displayName"
										id="searchPatternId" maxlength="30" size="30"
										style="width:60%; float:left;"
										styleClass="form-control searchBoxClass"
										value="#{searchClientAction.searchPattern}" />
									<h:commandButton action="#{searchClientAction.search}"
										style="float:left;margin-left :3px;"
										styleClass="btn btn-primary searchButtonClass"
										value="#{msg['client.search']}" />
								</div>
							</ox:decorate>
						</h:form>
						<div class="row">
							<div class="box-body">
								<div class="table-responsive" style="overflow: auto">
									<h:form id="clientsFormId">
										<ui:fragment
											rendered="#{searchClientAction.clientList.size() eq 0}">

											<h:outputText value="#{msg['client.noSearchResultFound']}" />
										</ui:fragment>
										<b:dataTable id="clientsListId" style="text-align:center;"
											rendered="#{searchClientAction.clientList.size() gt 0}"
											value="#{searchClientAction.clientList}" var="clt"
											print="true" excel="true" csv="true" pdf="true" select="true"
											responsive="true">
											<b:dataTableColumn label="#{msg['client.displayName']}"
												order="desc">
												<h:link includeViewParams="false"
													outcome="/client/updateClient" onclick="clearOIDC();"
													value="#{clt.displayName}">
													<f:param name="inum" value="#{clt.inum}" />
												</h:link>
											</b:dataTableColumn>
											<b:dataTableColumn value="#{clt.inum}"
												label="#{msg['client.inum']}" />
											<b:dataTableColumn label="#{msg['client.applicationType']}">
												<b:label text="#{clt.oxAuthAppType}" severity="primary" />
											</b:dataTableColumn>
											<b:dataTableColumn label="#{msg['passport.deleteProvider']}">
												<h:selectBooleanCheckbox id="selectId"
													onchange="displayButton();" value="#{clt.selected}" />
											</b:dataTableColumn>
										</b:dataTable>
										<a4j:commandButton ajaxSingle="true" id="deleteId"
											eventsQueue="clientQueue"
											onclick="#{rich:component('deleteConfirmation:acceptRemovalModalPanel')}.show();"
											styleClass="btn btn-primary DeleteBulkClients"
											style="float:left;margin-left :3px;" value="Delete" />
									</h:form>
								</div>
							</div>
						</div>
					</h:panelGroup>
					<div class="box-footer">
						<ui:insert name="controlButttons" />
					</div>
				</b:panel>
			</div>
		</div>
		<ox:acceptRemovalDialog
			deleteMethod="#{searchClientAction.deleteClients}"
			render="oidcClientsTable" id="deleteConfirmation" queue="clientQueue"
			subject="client" value="all selected clients" />
		<h:outputScript> 
	    	function displayButton() {  	
		    	var selectedIds = $("input[id$=selectId]:checked");
		    	deleteBtn = $("input[id$=deleteId]");
		    	
		    	if (selectedIds.length == 0) {
		    		deleteBtn.attr("disabled", "disabled");
		    	} else {
		    		deleteBtn.removeAttr("disabled");
		    	}
		    	
	    	} 
	    	displayButton();
   	</h:outputScript>
	</ui:define>
</ui:composition>