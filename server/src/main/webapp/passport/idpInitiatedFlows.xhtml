<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:b="http://bootsfaces.net/ui"
	xmlns:ox="http://xmlns.jcp.org/jsf/composite/ox"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:richext="http://xmlns.jcp.org/jsf/composite/richext"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	template="/WEB-INF/incl/layout/newtemplate.xhtml">
	<f:metadata>
		<f:viewAction
			action="#{permissionService.requestPermission('uma', 'access')}" />
		<f:viewAction action="#{conversationService.initConversation}" />
		<f:viewAction action="#{passportIdpInitiatedAction.init}"
			onPostback="false" />
	</f:metadata>

	<ui:define name="body">

		<section class="content-header">
			<h1 style="color: #333;">
				#{msg['passport.title']} <small> <i
					class="fa fa-caret-right" style="color: #333 !important;" />#{msg['passport.idpInitiated']}
				</small>
			</h1>
			<ol class="breadcrumb">
				<li><a href="#{request.contextPath}/home"> <i
						class="fa fa-home" />
				</a></li>
				<li class="organization/configuration"><a
					href="#{request.contextPath}/passport/idpInitiatedFlows">#{msg['passport.idpInitiated']}</a></li>
			</ol>
		</section>
		<section class="content">
			<div class="row">
				<div class="col-xs-12">
					<div class="box box-primary" style="min-height: 400px;">
						<div class="box-header"></div>
						<h:form id="IdpInitiatedForm">
							<input type='hidden' name='cid' value='#{conversation.id}' />
							<div class="row">
								<div class="col-xs-12">
									<!-- OIDC client section-->
									<h:panelGroup columns="1" width="100%"
										id="openIDConnectSection">
										<div class="row"
											style="margin-left: 5px; margin-right: 5px; margin-top: 10px;">
											<div class="col-sm-3 col-lg-3" style="padding: 0px;">
												<span
													style="font-weight: bold; font-size: medium; color: #00BE79; text-transform: uppercase;">
													#{msg['passport.idpinitiated.oidc.title']}</span>
											</div>
											<div class="col-sm-9 col-lg-9" style="padding: 0px;">
												<hr
													style="height: 1px; background: green; border-color: green; border-width: 0px;"></hr>
											</div>
										</div>

										<!-- First row-->
										<div class="row" style="margin-left: 5px; margin-right: 5px;">
											<!-- First column-->
											<div class="col-sm-6 col-lg-6" style="padding: 0px;">
												<ox:decorate
													label="#{msg['passport.idpinitiated.oidc.passport.authorizationEndpoint']}"
													leftClass="col-sm-3" rightClass="col-sm-9">
													<h:inputText
														styleClass="form-control AuthorizationEndPointID"
														style="width:100%" required="true"
														value="#{passportIdpInitiatedAction.iiConfiguration.openidclient.authorizationEndpoint}"
														id="AuthorizationEndPointID" rendered="true">
														<rich:validator event="blur" />
													</h:inputText>
												</ox:decorate>
												<ox:decorate
													label="#{msg['passport.idpinitiated.oidc.passport.acrValues']}"
													leftClass="col-sm-3" rightClass="col-sm-9"
													id="PostProfileEndpointID">
													<h:outputText styleClass="form-control AcrValuesID"
														style="width:100%" required="true"
														value="#{passportIdpInitiatedAction.iiConfiguration.openidclient.acrValues}"
														id="AcrValuesID">
													</h:outputText>
												</ox:decorate>
											</div>
											<!-- Second column-->
											<div class="col-sm-6 col-lg-6" style="padding: 0px;">
												<b:form horizontal="true">
													<b:formGroup>
														<b:selectOneMenu id="ClientID"
															value="#{passportIdpInitiatedAction.iiConfiguration.openidclient.clientId}"
															select2="true" colMd="9" required="true" labelColMd="3"
															label="#{msg['passport.idpinitiated.oidc.passport.clientId']}">
															<f:selectItem itemLabel="(Please select a client)"
																itemValue="" />
															<f:selectItems
																value="#{passportIdpInitiatedAction.clients}"
																var="client" itemValue="#{client.inum}"
																itemLabel="#{client.displayName}" />
														</b:selectOneMenu>
													</b:formGroup>
												</b:form>
											</div>
										</div>
									</h:panelGroup>
									<!-- AuthorizationParams section-->
									<h:panelGroup columns="1" width="100%" id="AuthParamsSection">
										<div class="row"
											style="margin-left: 5px; margin-right: 5px; margin-top: 10px;">
											<div class="col-sm-3 col-lg-3" style="padding: 0px;">
												<span
													style="font-weight: bold; font-size: medium; color: #00BE79; text-transform: uppercase;">
													#{msg['passport.idpinitiated.authParams.title']}</span>
											</div>
											<div class="col-sm-9 col-lg-9" style="padding: 0px;">
												<hr
													style="height: 1px; background: green; border-color: green; border-width: 0px;"></hr>
											</div>
										</div>
										<!-- AuthorizationParams List section-->
										<div class="row" style="margin-left: 5px; margin-right: 5px;">
											<h:outputText class="col-sm-offset-4 col-sm-4 col-xs-12"
												rendered="#{passportIdpInitiatedAction.authzParams.size() eq 0}"
												value="No Authenticate paramaters available yet." />
											<a4j:commandButton styleClass="btn btn-primary addNewParam"
												value="Add New AuthZParam"
												action="#{passportIdpInitiatedAction.activateForm}"
												render="AuthZParamFormId,IdpInitiatedForm" execute="@this" />
										</div>
										<!-- AuthorizationParams List not empty-->
										<div class="row" style="margin-left: 5px; margin-right: 5px;">
											<h:dataTable id="paramsTableId"
												rendered="#{(passportIdpInitiatedAction.authzParams.size() gt 0) and !passportIdpInitiatedAction.showForm}"
												rows="20" sortMode="single"
												styleClass="table table-hover rt paramsTableId"
												value="#{passportIdpInitiatedAction.authzParams}" var="clt">
												<h:column sortBy="#{clt.provider}">
													<f:facet name="header">
                                                                    #{msg['passport.idpinitiated.authParams.provider']}
                                                                </f:facet>
													<h:outputText class="col-xs-12" value="#{clt.provider}" />
												</h:column>
												<h:column>
													<f:facet name="header">
                                                                    #{msg['passport.idpinitiated.authParams.responseType']}
                                                                </f:facet>
													<h:outputText class="col-xs-12" value="#{clt.responseType}" />
												</h:column>
												<h:column>
													<f:facet name="header">
                                                                    #{msg['passport.idpinitiated.authParams.scope']}
                                                                </f:facet>
													<h:outputText class="col-xs-12" value="#{clt.scopes}" />
												</h:column>
												<h:column>
													<f:facet name="header">
                                                                    #{msg['passport.idpinitiated.authParams.redirectUri']}
                                                                </f:facet>
													<h:outputText class="col-xs-12" value="#{clt.redirectUri}" />
												</h:column>
												<h:column>
													<f:facet name="header">
                                                                    Actions
                                                                </f:facet>
													<a4j:commandButton
														styleClass="btn btn-primary cancelAuthParamId"
														value="Edit" style="margin-left: 5px;"
														action="#{passportIdpInitiatedAction.editAuthParam(clt)}"
														render="IdpInitiatedForm,AuthZParamFormId" execute="@this" />
													<a4j:commandButton
														styleClass="btn btn-primary deleteParamId" value="Remove"
														style="margin-left: 5px;"
														action="#{passportIdpInitiatedAction.removeAuthParam(clt)}"
														render="IdpInitiatedForm" execute="@this" />
												</h:column>
												<f:facet name="footer">
													<rich:dataScroller align="left" fastControls="hide"
														for="paramsTableId" maxPages="10"
														renderIfSinglePage="false"
														rendered="#{passportIdpInitiatedAction.authzParams.size() gt 0}"
														stepControls="auto" />
												</f:facet>
											</h:dataTable>
										</div>
									</h:panelGroup>
								</div>
								<h:panelGroup rendered="#{!passportIdpInitiatedAction.showForm}">
									<div class="row"
										style="margin-left: 15px; margin-right: 20px; margin-top: 10px; margin-bottom: 20px; border: 1px solid green; border-radius: 5px">
										<div id="updateButtons" style="margin-bottom: 10px;">
											<h:commandButton action="#{passportIdpInitiatedAction.save}"
												style="margin-left:5px;" styleClass="btn btn-primary"
												value="save" />
											<h:commandButton
												action="#{passportIdpInitiatedAction.cancel}"
												immediate="true" style="margin-left:5px;"
												styleClass="btn btn-primary" value="#{msg['client.cancel']}" />
										</div>
									</div>
								</h:panelGroup>
							</div>
						</h:form>
						<h:form id="AuthZParamFormId">
							<!-- Add new Param form-->
							<h:panelGroup id="ParamFormID"
								rendered="#{passportIdpInitiatedAction.showForm}">
								<div class="row"
									style="margin-left: 5px; margin-right: 5px; margin-top: 10px; margin-bottom: 20px; border: 1px solid green; border-radius: 5px">
									<!-- First column-->
									<div class="col-sm-6 col-lg-6" style="padding: 0px;">
										<b:form horizontal="true">
											<b:formGroup>
												<b:selectOneMenu id="ProviderID"
													value="#{passportIdpInitiatedAction.authzParam.provider}"
													select2="true" colMd="9" required="true" labelColMd="3"
													label="#{msg['passport.idpinitiated.authParams.provider']}">
													<f:selectItem itemLabel="(Please select a provider"
														itemValue="" />
													<f:selectItems
														value="#{passportIdpInitiatedAction.providers}"
														var="provider" itemValue="#{provider.id}"
														itemLabel="#{provider.displayName}" />
												</b:selectOneMenu>
											</b:formGroup>
										</b:form>
										<ox:decorate
											label="#{msg['passport.idpinitiated.authParams.redirectUri']}"
											leftClass="col-sm-3" rightClass="col-sm-9" id="RedirectURI">
											<h:inputText styleClass="rounded form-control RedirectURI"
												id="RedirectURI" style="width:100%" required="true"
												value="#{passportIdpInitiatedAction.authzParam.redirectUri}">
												<rich:validator event="blur" />
											</h:inputText>
										</ox:decorate>
									</div>
									<!-- Second column-->
									<div class="col-sm-6 col-lg-6" style="padding: 0px;">
										<b:form horizontal="true">
											<b:formGroup>
												<b:inputText tags="true"
													label="#{msg['passport.idpinitiated.authParams.responseType']}"
													required="true" colMd="9" labelColMd="3"
													value="#{passportIdpInitiatedAction.authzParam.responseType}"
													placeholder="Select few scopes" typeahead="true"
													typeahead-values="#{passportIdpInitiatedAction.responseTypes}"
													tiny-screen="full-width" />
											</b:formGroup>
											<b:formGroup>
												<b:selectMultiMenu id="ScopesID"
													value="#{passportIdpInitiatedAction.authzParam.scopes}"
													select2="true" colMd="9" required="true" labelColMd="3"
													label="#{msg['passport.idpinitiated.authParams.scope']}">
													<f:selectItem itemLabel="(Please select some scopes)"
														itemValue="" />
													<f:selectItems value="#{passportIdpInitiatedAction.scopes}"
														var="s" itemValue="#{s}" itemLabel="#{s}" />
												</b:selectMultiMenu>
											</b:formGroup>
										</b:form>
									</div>
									<!-- Form footer-->
									<div class="row"
										style="margin-left: 50px; margin-right: 5px; margin-bottom: 20px;">
										<div id="updateButtons">
											<a4j:commandButton
												styleClass="btn btn-primary saveAuthParamId"
												onclick="submit();" value="#{msg['client.add']}"
												style="margin-left: 5px;"
												action="#{passportIdpInitiatedAction.addAuthParam}"
												render="AuthZParamFormId" execute="@this" />
											<a4j:commandButton
												styleClass="btn btn-primary cancelAuthParamId"
												value="#{msg['client.cancel']}" style="margin-left: 5px;"
												action="#{passportIdpInitiatedAction.cancelParamAdd}"
												render="AuthZParamFormId,IdpInitiatedForm" execute="@this" />
										</div>
									</div>
								</div>
							</h:panelGroup>
						</h:form>
					</div>
				</div>
			</div>
		</section>

	</ui:define>
</ui:composition>
