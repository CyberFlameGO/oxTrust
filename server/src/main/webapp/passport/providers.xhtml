<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ox="http://xmlns.jcp.org/jsf/composite/ox"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:richext="http://xmlns.jcp.org/jsf/composite/richext"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	template="/WEB-INF/incl/layout/newtemplate.xhtml">
	<f:metadata>
		<f:viewAction
			action="#{permissionService.requestPermission('uma', 'access')}" />
		<f:viewAction action="#{conversationService.initConversation}" />
		<f:viewAction action="#{passportProvidersAction.init}"
			onPostback="false" />
	</f:metadata>
	<ui:define name="body">
		<section class="content-header">
			<h1 style="color: #333;">
				#{msg['passport.title']} <small> <i
					class="fa fa-caret-right" style="color: #333 !important;" />#{msg['passport.providers']}
				</small>
			</h1>
			<ol class="breadcrumb">
				<li><a href="#{request.contextPath}/home"> <i
						class="fa fa-home" />
				</a></li>
				<li class="organization/configuration"><a
					href="#{request.contextPath}/passport/idpInitiatedFlows">#{msg['passport.idpInitiated']}</a></li>
			</ol>
		</section>
		<section class="content">
			<div class="row">
				<div class="col-xs-12">
					<div class="box box-primary" style="min-height: 400px;">
						<div class="box-header"></div>
						<!-- start providers list-->
						<h:panelGroup id="providersTable">
							<div class="row"
								style="padding: 5px; margin-bottom: 5px; margin-left: 15px">
								<h:link includeViewParams="false"
									outcome="/passport/addProvider"
									styleClass="btn btn-primary addProviderButtonClass"
									value="#{msg['passport.addNewProvider']}" />
							</div>
							<div class="box-body">
								<div class="table-responsive" style="overflow: auto">
									<h:form id="providersForm">
										<ui:fragment
											rendered="#{passportProvidersAction.providers.size() eq 0}">
											<h:outputText value="No result" />
										</ui:fragment>

										<h:dataTable id="providersTableId"
											rendered="#{passportProvidersAction.providers.size() gt 0}"
											rows="20" sortMode="single"
											styleClass="table table-hover rt providersListClass"
											value="#{passportProvidersAction.providerSelections}" var="clt">
											<h:column sortBy="#{clt.provider.id}">
												<f:facet name="header">
													<div style="margin-left: 20px;">#{msg['passport.provider.form.id']}</div>
												</f:facet>
												<h:link includeViewParams="false"
													outcome="/passport/editProvider" value="#{clt.provider.id}">
													<f:param name="id" value="#{clt.provider.id}" />
												</h:link>
											</h:column>
											<h:column sortBy="#{clt.provider.displayName}">
												<f:facet name="header">
                                                                    #{msg['passport.provider.form.displayName']}
                                                                </f:facet>
												<h:link includeViewParams="false"
													outcome="/passport/editProvider" value="#{clt.provider.displayName}">
													<f:param name="id" value="#{clt.provider.id}" />
												</h:link>
											</h:column>
											<h:column>
												<f:facet name="header">
                                                                    #{msg['passport.provider.form.strategyId']}
                                                                </f:facet>
												<h:outputText class="col-xs-12"
													value="#{clt.provider.passportStrategyId}" />
											</h:column>
											<h:column>
												<f:facet name="header">
                                                                    #{msg['passport.provider.form.type']}
                                                                </f:facet>
												<h:outputText class="col-xs-12" value="#{clt.provider.type}" />
											</h:column>
											<h:column>
												<f:facet name="header">
                                                                     #{msg['passport.deleteProvider']}
                                                                </f:facet>
												<h:selectBooleanCheckbox id="selectId"
													onchange="displayButton();" value="#{clt.checked}">
												</h:selectBooleanCheckbox>

											</h:column>
											<f:facet name="footer">
												<rich:dataScroller align="left" fastControls="hide"
													for="providersTableId" maxPages="10"
													renderIfSinglePage="false"
													rendered="#{passportProvidersAction.providers.size() gt 0}"
													stepControls="auto" />
											</f:facet>
										</h:dataTable>
										<a4j:commandButton ajaxSingle="true" id="deleteId"
											eventsQueue="providerQueue"
											rendered="#{passportProvidersAction.providers.size() gt 0}"
											onclick="#{rich:component('deleteConfirmation:acceptRemovalModalPanel')}.show();"
											styleClass="btn btn-primary DeleteBulkProviders"
											style="float:left;margin-left :3px;"
											value="#{msg['passport.deleteProvider']}" />
									</h:form>
								</div>
								<ox:acceptRemovalDialog
									deleteMethod="#{passportProvidersAction.deleteProviders}"
									render="providersTableId" id="deleteConfirmation"
									queue="providerQueue" subject="provider"
									value="all selected providers" />
							</div>
						</h:panelGroup>
						<script>
						$(document).ready(function() {
			       });
						</script>
						<!-- end providers list-->
					</div>
				</div>
			</div>
		</section>
		<h:outputScript> 
	    	function displayButton() {  	
		    	var selectedIds = $("input[id$=selectId]:checked");
		    	deleteBtn = $("input[id$=deleteId]");
		    	
		    	if (selectedIds.length == 0) {
		    		deleteBtn.attr("disabled", "disabled");
		    	} else {
		    		deleteBtn.removeAttr("disabled");
		    	}
		    	
	    	} 
	    	displayButton();
   	</h:outputScript>
	</ui:define>
</ui:composition>
